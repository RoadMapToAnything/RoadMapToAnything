<!-- Roadmap Header -->
<div class="row center-align">
  <div class="col s9 roadmap-title">
    <h3 ng-bind="map.title"></h3>
    <p ng-bind="map.description"></p>
  </div>
  <div class="col s3">
    <div class="upvotes-container">
      <a title="Upvote roadmap" class="btn-floating waves-effect waves-light teal lighten-2" ng-click="upvote()"><i class="large material-icons">expand_less</i></a>
      <span class="total-upvotes {{ getUpvoteClass() }}">{{ map.upvotes.length - map.downvotes.length }}</span>
      <a title="Downvote roadmap" class="btn-floating waves-effect waves-light red lighten-2" ng-click="downvote()"><i class="large material-icons">expand_more</i></a>
    </div>
  </div>
</div>


<!-- Node List -->
<div class="node-list container">

  <div class="node-container" ng-repeat="node in map.nodes">
    <div class="timeline-column">
      <div class="fixed-action-btn horizontal">
        <a class="btn-floating btn-large {{ getNodeColor(node) }}" ng-click="selectNode(node)">
          <i class="large material-icons">change_history</i> <!-- TODO: icon from type -->
        </a>

        <ul>
          <li><a class="btn-floating red lighten-2" title="Edit node" ng-click="editNode(node)" ng-show="isAuthor() && !isEditing(node)"><i class="material-icons">mode_edit</i></a></li>
          <li><a class="btn-floating amber darken-1" title="Add new node below" ng-click="addNode($index)" ng-show="isAuthor()"><i class="material-icons">add</i></a></li>
          <li><a class="btn-floating teal lighten-2" title="Mark node as completed!" ng-click="completeNode(node)" ng-hide="isCompleted(node)"><i class="material-icons">done</i></a></li>
        </ul>

      </div> <!-- /fixed-action-btn -->
    </div> <!-- /timeline-column -->

    <div class="node-title">{{ truncate(node.title, 24) }}</div>

    <div class="timeline-column">
      <div ng-hide="$last" class="vertical-rule"></div>
    </div>

  </div> <!-- /ng-repeat -->
</div> <!-- /node-list -->


<!-- Selected Node Card -->
<div class="selected-card" ng-show="selected">
  <div class="card">

    <div class="card-action">
      <a href="{{ selected.resourceURL }}" target="_blank" ng-hide="isEditing()">{{ truncate(selected.resourceURL, 36) }}</a>
      <textarea class="editable-text clipped" rows="1" ng-model="selected.resourceURL" ng-change="scrapeSelected()" ng-show="isEditing()"></textarea>
    </div>

    <div class="card-image">
      <img src="{{ selected.imageUrl }}" ng-show="selected.imageUrl">
      <div class="image-placeholder" ng-hide="selected.imageUrl"><i class="large material-icons">change_history</i></div>
      <span class="card-title"><textarea class="editable-text clipped" rows="1" ng-model="selected.title" ng-disabled="!isEditing()"></textarea></span>
    </div>

    <div class="card-content">
      <p><textarea class="editable-text" rows="4" ng-model="selected.description" ng-disabled="!isEditing()"></textarea></p>
    </div>

    <div class="card-action" ng-show="isAuthor()">
      <a ng-click="updateSelected()" ng-show="isEditing()">Save Node</a>
      <a ng-click="editNode()" ng-hide="isEditing()">Edit Node</a>
    </div>
  </div>
</div>


<!-- Comments Section -->
<a class="waves-effect waves-teal btn-flat" ng-click="toggleComments()">
  <span ng-hide="isCommentsVisible()">Show</span>
  <span ng-show="isCommentsVisible()">Hide</span>
   Comments
</a>
<hr ng-hide="isCommentsVisible()">

<ul id="comments-section" class="collection">
  <li class="collection-item">
    <div class="row">
      <span class="title">Leave A Comment</span>
      <a class="secondary-content" title="Sumbit your comment!" ng-click="submitComment()"><i class="medium material-icons">done</i></a>
    </div>
    <div class="row">
      <div class="input-field col s9">
        <input id="comment-title" type="text" ng-model="commentTitle">
        <label for="comment-title">Title</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12">
        <input id="comment-content" type="text" ng-model="commentContent">
        <label for="comment-content">Content</label>
      </div>
    </div>
  </li>

  <li class="collection-item avatar {{ getCommentClass($index) }}" ng-repeat="comment in map.comments">
    <img ng-src="{{ comment.author.imageUrl }}" alt="User icon" class="comment-avatar">
    <span class="title">{{ comment.subject }}</span>
    <p>{{ comment.content }}</p>
  </li>

</ul>